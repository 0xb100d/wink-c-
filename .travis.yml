language: cpp

script:
  - cmake -DCMAKE_BUILD_TYPE=Debug .
  # - make
  # - ctest --verbose

matrix:
  include:
    # - os: osx
    #   osx_image: xcode9.3
    #   before_install: brew install openssl
    #   env: OPENSSL_ROOT_DIR="/usr/local/opt/openssl"

    - os: linux
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-7
            - cmake-data
            - cmake
            - libboost-all-dev
            - libssl-dev
      before_install:
        - eval "CC=gcc-7 && CXX=g++-7"
      before_deploy:
        # Set up git user name and tag this commit
        - git config --local user.name "Vadim Grigoruk"
        - git config --local user.email "vadim@beam-mw.com"
        - git tag "$(date +'%Y%m%d%H%M%S')-$(git log --format=%h -1)"
      deploy:
        provider: releases
        api_key: $GITHUB_OAUTH_TOKEN
        file: Makefile
        skip_cleanup: true
        on:
          tags: true
          all_branches: true

# notifications:
#   email:
#     - big.romanov@gmail.com
